<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from burner-docs.local/api/ui_Spinner.js.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 09 Aug 2016 23:19:14 GMT -->
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ui/Spinner.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ui/Spinner.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * src/ui/Spinner.js
 * Author: H.Alper Tuna &lt;halpertuna@gmail.com>
 * Date: 08.08.2016
 */

define([
    '../core/Utils',
    './Button', './ComponentContainer', './Element', './Group', './Input',
    './interfaces/iComponent', './interfaces/iInput'
], function(
    Utils,
    Button, ComponentContainer, Element, Group, Input,
    iComponent, iInput
){
    function countFaster(direction){
        direction *= 10;
        increase.call(this, direction);
        clearTimeout(this.get('clock'));
        this.set('clock', setInterval(increase.bind(this, direction), 40));
    }
    function countFast(direction){
        increase.call(this, direction);
        clearTimeout(this.get('clock'));
        this.set('clock', setInterval(increase.bind(this, direction), 40));
        this.set('delay', setTimeout(countFaster.bind(this, direction), 2000));
    }
    function countSlow(direction){
        increase.call(this, direction);
        this.set('clock', setInterval(increase.bind(this, direction), 160));
        this.set('delay', setTimeout(countFast.bind(this, direction), 1000));
    }
    function abortCount(){
        clearTimeout(this.get('delay'));
        clearTimeout(this.get('clock'));
    }
    function waitToCount(direction){
        increase.call(this, direction);
        this.set('delay', setTimeout(countSlow.bind(this, direction), 500));
    }

    function increase(direction){
        var value = this.get('value') + direction;
        if(this.get('loop')){
            var max = this.get('max');
            var min = this.get('min');
            if(value > max) value = min;
            else if(value &lt; min) value = max;
            this.set('value', value);
            repaint.call(this);
            return this.ref;
        }

        var input = this.get('input');
        input.setValue(value);
        validate.call(this);
        emitChange.call(this);
        return this.ref;
    }
    function validate(){
        var value = Utils.toFloat(this.get('input').getValue());
        var max = this.get('max');
        var min = this.get('min');

        if(Utils.isSet(max) &amp;&amp; value > max){
            value = max;
            abortCount.call(this);
        }else if(Utils.isSet(min) &amp;&amp; value &lt; min){
            value = min;
            abortCount.call(this);
        }

        this.set('value', value);
        repaint.call(this);
        return this.ref;
    }
    function emitChange(){
        this.emit('change', {
            'value': this.getValue()
        });
    }
    function repaint(){
        //this.get('input').getDom().value = this.get('value'); //To avoid onchange loop
        var value = this.get('value');
        var pad = this.get('pad');
        if(Utils.isSet(pad))
            value = Utils.pad(value, pad);
        this.get('input').setValue(value);
        return this.ref;
    }

    return ComponentContainer.extend(/** @lends ui/Spinner# */{
        /**
         * Spinner component class.
         * @constructs
         * @augments ui/ComponentContainer
         * @implements iInput
         * @implements iComponent
         */
        'init': function(){
            /**
             * Change event.
             * @event ui/Spinner.ui/Spinner:change
             * @param {number} value - New value of spinner.
             */
            var group = Group.new();
            this.super(group);
            this.handle('change');

            var input = Input.new()
                .on('change', validate.bind(this))
                .on('change', emitChange.bind(this));
            var buttonDown = Button.new()
                .setIcon('angle-down');
            buttonDown.getDom().addEventListener('mousedown', waitToCount.bind(this, -1));
            buttonDown.getDom().addEventListener('mouseup', abortCount.bind(this));
            buttonDown.getDom().addEventListener('mouseout', abortCount.bind(this));
            var buttonUp = Button.new()
                .setIcon('angle-up');
            buttonUp.getDom().addEventListener('mousedown', waitToCount.bind(this, 1));
            buttonUp.getDom().addEventListener('mouseup', abortCount.bind(this));
            buttonUp.getDom().addEventListener('mouseout', abortCount.bind(this));

            this.set('value', 0);
            this.set('input', input);
            this.set('buttonUp', buttonUp);
            this.set('buttonDown', buttonDown);
            group.addClass('jb-spinner');
            group.add(
                buttonDown,
                input,
                buttonUp
            );
            repaint.call(this);


            //TODO have to check
            //this.setDefaultValue(0);
        },

        //Inherited from iInput interface
        'getValue': function(){
            return this.get('value');
        },
        //Inherited from iInput interface
        'setValue': function(value){
            this.get('input').setValue(value);
            validate.call(this);
            return this.ref;
        },
        //TODO have to check
        'defaultValue': 0,
        //Inherited from iInput interface
        'setDefaultValue': function(value){
            this.setValue(value);
            this.set('defaultValue', this.getValue());
            return this.ref;
        },
        //Inherited from iInput interface
        'resetValue': function(){
            return this.setValue(this.get('defaultValue'));
        },
        //Inherited from iComponent interface
        'focus': function(){
            return this.get('input').focus();
        },
        //Inherited from iComponent interface
        'setTheme': function(theme){
            this.getComponent().setTheme(theme);
        },
        //Inherited from iComponent interface
        'setDisabled': function(value){
            this.getComponent().setDisabled(value);
        },

        'buttonsAreShown': true,
        /**
         * Sets visibility state of increase / decrease buttons.
         * @param {boolean} value - Visibility state.
         * @return {Object} Instance reference.
         */
        'showButtons': function(value){
            if(this.get('buttonsAreShown') == value) return this.ref;

            if(value){
                this.getComponent()
                    .prepend(this.get('buttonDown'))
                    .add(this.get('buttonUp'));
            }else{
                this.get('buttonDown').remove();
                this.get('buttonUp').remove();
            }

            this.set('buttonsAreShown', value);
            return this.ref;
        },

        /**
         * Sets maximum value of spinner.
         * @param {number} value - Maximum value.
         * @return {Object} Instance reference.
         */
        'setMax': function(value){
            if(value === null) this.set('loop', false);
            this.set('max', value);
            validate.call(this);
            return this.ref;
        },
        'min': 0,
        /**
         * Sets minimum value of spinner.
         * @param {number} value - Minimum value.
         * @return {Object} Instance reference.
         */
        'setMin': function(value){
            if(value === null) this.set('loop', false);
            this.set('min', value);
            validate.call(this);
            return this.ref;
        },
        'loop': false,
        /**
         * Sets loop state of spinner. If true, when it reach minimum or maximum limit, it returns other limit.
         * @param {bootlean} value - Loop state.
         * @return {Object} Instance reference.
         */
        'setLoop': function(value){
            return this.set('loop', Utils.isSet(this.get('max'), this.get('min')) ? value : false);
        },
        /**
         * Sets pad length to put zero.
         * @param {number} value - Pad length.
         * @return {Object} Instance reference.
         */
        'setPad': function(value){
            if(value === false)
                this.unset('pad');
            else
                this.set('pad', value);
            repaint.call(this);
            return this.ref;
        }
    }).implement(iComponent, iInput)
})
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index-2.html">Home</a></h2><h3>Classes</h3><ul><li><a href="core_Ajax.html">core/Ajax</a></li><li><a href="core_AjaxGroup.html">core/AjaxGroup</a></li><li><a href="core_createClass.html">core/createClass</a></li><li><a href="core_EventHandler.html">core/EventHandler</a></li><li><a href="core_Utils.html">core/Utils</a></li><li><a href="ui_Breadcrumb.html">ui/Breadcrumb</a></li><li><a href="ui_Button.html">ui/Button</a></li><li><a href="ui_Check.html">ui/Check</a></li><li><a href="ui_CheckGroup.html">ui/CheckGroup</a></li><li><a href="ui_ComponentContainer.html">ui/ComponentContainer</a></li><li><a href="ui_Document.html">ui/Document</a></li><li><a href="ui_Dropdown.html">ui/Dropdown</a></li><li><a href="ui_Element.html">ui/Element</a></li><li><a href="ui_Group.html">ui/Group</a></li><li><a href="ui_Icon.html">ui/Icon</a></li><li><a href="ui_Input.html">ui/Input</a></li><li><a href="ui_Label.html">ui/Label</a></li><li><a href="ui_List.html">ui/List</a></li><li><a href="ui_Message.html">ui/Message</a></li><li><a href="ui_Notifier.html">ui/Notifier</a></li><li><a href="ui_Popup.html">ui/Popup</a></li><li><a href="ui_RadioGroup.html">ui/RadioGroup</a></li><li><a href="ui_Spinner.html">ui/Spinner</a></li><li><a href="ui_Switch.html">ui/Switch</a></li><li><a href="ui_TextElement.html">ui/TextElement</a></li><li><a href="ui_Tip.html">ui/Tip</a></li></ul><h3>Events</h3><ul><li><a href="core_Ajax.html#.event:core/Ajax:always">core/Ajax:always</a></li><li><a href="core_Ajax.html#.event:core/Ajax:fail">core/Ajax:fail</a></li><li><a href="core_Ajax.html#.event:core/Ajax:maxConnection">core/Ajax:maxConnection</a></li><li><a href="core_Ajax.html#.event:core/Ajax:send">core/Ajax:send</a></li><li><a href="core_Ajax.html#.event:core/Ajax:success">core/Ajax:success</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:change">core/AjaxGroup:change</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:closedConnection">core/AjaxGroup:closedConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:closedLastConnection">core/AjaxGroup:closedLastConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:maxConnection">core/AjaxGroup:maxConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:openedConnection">core/AjaxGroup:openedConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:openedFirstConnection">core/AjaxGroup:openedFirstConnection</a></li><li><a href="ui_Button.html#.event:ui/Button:click">ui/Button:click</a></li><li><a href="ui_Check.html#.event:ui/Check:change">ui/Check:change</a></li><li><a href="ui_Check.html#.event:ui/Check:click">ui/Check:click</a></li><li><a href="ui_CheckGroup.html#.event:ui/CheckGroup:change">ui/CheckGroup:change</a></li><li><a href="ui_Dropdown.html#.event:ui/Dropdown:change">ui/Dropdown:change</a></li><li><a href="ui_Element.html#.event:ui/Element:hide">ui/Element:hide</a></li><li><a href="ui_Element.html#.event:ui/Element:show">ui/Element:show</a></li><li><a href="ui_Input.html#.event:ui/Input:change">ui/Input:change</a></li><li><a href="ui_List.html#.event:ui/List:change">ui/List:change</a></li><li><a href="ui_List.html#.event:ui/List:selectedInternally">ui/List:selectedInternally</a></li><li><a href="ui_RadioGroup.html#.event:ui/RadioGroup:change">ui/RadioGroup:change</a></li><li><a href="ui_Spinner.html#.event:ui/Spinner:change">ui/Spinner:change</a></li><li><a href="ui_Switch.html#.event:ui/Switch:change">ui/Switch:change</a></li><li><a href="ui_Switch.html#.event:ui/Switch:click">ui/Switch:click</a></li></ul><h3>Interfaces</h3><ul><li><a href="iComponent.html">iComponent</a></li><li><a href="iInput.html">iInput</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Aug 10 2016 01:17:51 GMT+0300 (EEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>

<!-- Mirrored from burner-docs.local/api/ui_Spinner.js.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 09 Aug 2016 23:19:14 GMT -->
</html>
