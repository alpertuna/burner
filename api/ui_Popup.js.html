<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from burner-docs.local/api/ui_Popup.js.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 09 Aug 2016 23:19:14 GMT -->
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ui/Popup.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ui/Popup.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * src/ui/Popup.js
 * Author: H.Alper Tuna &lt;halpertuna@gmail.com>
 * Date: 08.08.2016
 */

'use strict';

define([
    '../core/Utils',
    './Element', './Group',
    './utils/SpaceFinder'
], function(
    Utils,
    Element, Group,
    SpaceFinder
){
    var shownPopup;

    function targetClickedInClickMode(e){
        if(this.hasClass('jb-hidden')){
            this.show();
        }else
            this.hide();
        e.stopPropagation();
    }
    function popupOnShowInClickMode(){
        //Close Other Popup
        if(shownPopup &amp;&amp; shownPopup !== this) shownPopup.hide();
        shownPopup = this;

        //Put hide trigger
        window.addEventListener('click', this.hide);
    }
    function popupOnHideInClickMode(){
        shownPopup = null;

        //Remove hide trigger
        window.removeEventListener('click', this.hide);
    }
    function stopPropagation(e){
        e.stopPropagation();
    }
    function adjustPosition(){
        if(!this.getParent())
            this.get('target').add(this);

        //Remove prev styles affects position to avoid incorrect rect
        this.removeClass('jb-popup-align-top jb-popup-align-bottom jb-popup-align-left jb-popup-align-right');
        this.removeStyle('height'); //Full client height cases

        var targetRect = this.get('targetDom').getBoundingClientRect();
        targetRect.relativeTop = this.get('targetDom').offsetTop;
        targetRect.relativeLeft = this.get('targetDom').offsetLeft;
        var thisRect = this.getDom().getBoundingClientRect();

        var result = SpaceFinder.find(
            targetRect,
            thisRect,
            this.get('direction'),
            this.get('align')
        );

        if(result.popupClass)
            this.addClass(result.popupClass);

        //Result
        this.setStyle({
            'top': result.top,
            'left': result.left
        });

        //Calculate overflow for full client height
        //TODO This control is designed for Dropdown List, it has to be ready for other components
        if(result.height !== false){
            if(!this.getChildAt(0).getComponent) return;

            var computedStylesComponent = window.getComputedStyle(this.getChildAt(0).getComponent().getDom(), null);
            var computedStylesPopup = window.getComputedStyle(this.getDom(), null);
            result.height -= (
                parseInt(computedStylesComponent.getPropertyValue('padding-top')) +
                parseInt(computedStylesComponent.getPropertyValue('border-top-width'))
            ) * 2 +
            parseInt(computedStylesPopup.getPropertyValue('padding-top')) * 2;

            this.setStyle('height', result.height);
        }
    }

    return Element.extend(/** @lends ui/Popup# */{
        /**
         * Popup component class.
         * @constructs
         * @param {ui/Element} content - An element as content
         * @augments ui/Element
         */
        'init': function(content){
            this.super();
            this.addClass('jb-popup');
            this.hide();
            this.on('show', adjustPosition.bind(this));

            if(content)
                this.add(content);
        },

        'direction': 'TOP',
        'align': 'CENTER',
        /**
         * Sets direction of popup to target component.
         * @param {string} direction - Direction name. Options are TOP, BOTTOM, RIGHT, LEFT.
         * @param {string} align - Align name. Options are CENTER, MIDDLE, TOP, BOTTOM, RIGHT, LEFT.
         * @return {Object} Instance reference.
         */
        'setDirection': function(direction, align){
            //TODO error (also include default align value)
            switch(direction){
                case 'TOP':
                case 'BOTTOM':
                    if(Utils.isUnset(align))
                        align = 'CENTER';
                    else if(align != 'LEFT' &amp;&amp; align != 'RIGHT' &amp;&amp;  align != 'CENTER')
                        throw 'Align have to be LEFT, RIGHT or CENTER for direction ' + direction;
                    break;
                case 'LEFT':
                case 'RIGHT':
                    if(Utils.isUnset(align))
                        align = 'MIDDLE';
                    else if(align != 'TOP' &amp;&amp; align != 'BOTTOM' &amp;&amp;  align != 'MIDDLE')
                        throw 'Align have to be TOP, BOTTOM or MIDDLE for direction ' + direction;
                    break;
                default:
                    throw 'Direction have to be one of TOP, BOTTOM, LEFT and RIGHT';
            }

            this.set('direction', direction);
            this.set('align', align);

            return this.ref;
        },

        'bound': false,
        /**
         * Binds popup to a component.
         * @param {ui/ComponentContainer} target - Target component.
         * @param {string} [trigger=HOVER] - Trigger name. Options are CLICK, HOVER, FOCUS, NONE.
         * @return {Object} Instance reference.
         */
        'bind': function(target, trigger){
            //TODO Error
            if(this.get('bound')) throw 'Popup is already bound.';
            this.set('bound', true);
            //TODO error
            if(!target.hasClass('jb-com-container'))
                throw 'To bind popup, component has to have container.';

            var targetComponent = target.getComponent();
            var targetComponentDom = targetComponent.getDom();

            this.set('target', target);
            this.set('targetComponent', targetComponent);
            this.set('targetDom', targetComponent.getDom());

            if(trigger == 'NONE') return this;

            switch(trigger){
                case 'FOCUS':
                    targetComponentDom.addEventListener('focus', this.show);
                    targetComponentDom.addEventListener('blur', this.hide);
                    break;
                case 'CLICK':
                    target.on('click', targetClickedInClickMode.bind(this));
                    this.on('show', popupOnShowInClickMode.bind(this));
                    this.on('hide', popupOnHideInClickMode.bind(this));
                    this.getDom().addEventListener('click', stopPropagation.bind(this));
                    break;
                case 'HOVER':
                default:
                    targetComponentDom.addEventListener('mouseover', this.show);
                    targetComponentDom.addEventListener('mouseout', this.hide);
                    break;
            }

            return this.ref;
        }
    });
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index-2.html">Home</a></h2><h3>Classes</h3><ul><li><a href="core_Ajax.html">core/Ajax</a></li><li><a href="core_AjaxGroup.html">core/AjaxGroup</a></li><li><a href="core_createClass.html">core/createClass</a></li><li><a href="core_EventHandler.html">core/EventHandler</a></li><li><a href="core_Utils.html">core/Utils</a></li><li><a href="ui_Breadcrumb.html">ui/Breadcrumb</a></li><li><a href="ui_Button.html">ui/Button</a></li><li><a href="ui_Check.html">ui/Check</a></li><li><a href="ui_CheckGroup.html">ui/CheckGroup</a></li><li><a href="ui_ComponentContainer.html">ui/ComponentContainer</a></li><li><a href="ui_Document.html">ui/Document</a></li><li><a href="ui_Dropdown.html">ui/Dropdown</a></li><li><a href="ui_Element.html">ui/Element</a></li><li><a href="ui_Group.html">ui/Group</a></li><li><a href="ui_Icon.html">ui/Icon</a></li><li><a href="ui_Input.html">ui/Input</a></li><li><a href="ui_Label.html">ui/Label</a></li><li><a href="ui_List.html">ui/List</a></li><li><a href="ui_Message.html">ui/Message</a></li><li><a href="ui_Notifier.html">ui/Notifier</a></li><li><a href="ui_Popup.html">ui/Popup</a></li><li><a href="ui_RadioGroup.html">ui/RadioGroup</a></li><li><a href="ui_Spinner.html">ui/Spinner</a></li><li><a href="ui_Switch.html">ui/Switch</a></li><li><a href="ui_TextElement.html">ui/TextElement</a></li><li><a href="ui_Tip.html">ui/Tip</a></li></ul><h3>Events</h3><ul><li><a href="core_Ajax.html#.event:core/Ajax:always">core/Ajax:always</a></li><li><a href="core_Ajax.html#.event:core/Ajax:fail">core/Ajax:fail</a></li><li><a href="core_Ajax.html#.event:core/Ajax:maxConnection">core/Ajax:maxConnection</a></li><li><a href="core_Ajax.html#.event:core/Ajax:send">core/Ajax:send</a></li><li><a href="core_Ajax.html#.event:core/Ajax:success">core/Ajax:success</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:change">core/AjaxGroup:change</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:closedConnection">core/AjaxGroup:closedConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:closedLastConnection">core/AjaxGroup:closedLastConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:maxConnection">core/AjaxGroup:maxConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:openedConnection">core/AjaxGroup:openedConnection</a></li><li><a href="core_AjaxGroup.html#.event:core/AjaxGroup:openedFirstConnection">core/AjaxGroup:openedFirstConnection</a></li><li><a href="ui_Button.html#.event:ui/Button:click">ui/Button:click</a></li><li><a href="ui_Check.html#.event:ui/Check:change">ui/Check:change</a></li><li><a href="ui_Check.html#.event:ui/Check:click">ui/Check:click</a></li><li><a href="ui_CheckGroup.html#.event:ui/CheckGroup:change">ui/CheckGroup:change</a></li><li><a href="ui_Dropdown.html#.event:ui/Dropdown:change">ui/Dropdown:change</a></li><li><a href="ui_Element.html#.event:ui/Element:hide">ui/Element:hide</a></li><li><a href="ui_Element.html#.event:ui/Element:show">ui/Element:show</a></li><li><a href="ui_Input.html#.event:ui/Input:change">ui/Input:change</a></li><li><a href="ui_List.html#.event:ui/List:change">ui/List:change</a></li><li><a href="ui_List.html#.event:ui/List:selectedInternally">ui/List:selectedInternally</a></li><li><a href="ui_RadioGroup.html#.event:ui/RadioGroup:change">ui/RadioGroup:change</a></li><li><a href="ui_Spinner.html#.event:ui/Spinner:change">ui/Spinner:change</a></li><li><a href="ui_Switch.html#.event:ui/Switch:change">ui/Switch:change</a></li><li><a href="ui_Switch.html#.event:ui/Switch:click">ui/Switch:click</a></li></ul><h3>Interfaces</h3><ul><li><a href="iComponent.html">iComponent</a></li><li><a href="iInput.html">iInput</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Aug 10 2016 01:17:51 GMT+0300 (EEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>

<!-- Mirrored from burner-docs.local/api/ui_Popup.js.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 09 Aug 2016 23:19:14 GMT -->
</html>
